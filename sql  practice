-- select department_id,count(*) as total_employees from hr.EMPLOYEES group by DEPARTMENT_ID
-- select department_id,avg(salary) as avg_salary from hr.EMPLOYEES group by department_id
-- select department_id ,max(salary) as max_salary from hr.EMPLOYEES group by DEPARTMENT_ID
-- select department_Id ,min(salary) as min_salary from hr.employees group by DEPARTMENT_ID
-- select department_Id,sum(salary) as sum_salary from hr.EMPLOYEES group by DEPARTMENT_ID
-- select job_id,count(*) as empolyee_count from hr.employees group by JOB_ID  
-- select job_id,avg(salary) as avg_salry from hr.employees GROUP by job_id
-- select job_id,max(salary) as max_salry from hr.employees GROUP by job_id
-- select job_id,min(salary) as min_salry from hr.employees GROUP by job_id
-- select job_id,sum(salary) as sum_salry from hr.employees GROUP by job_id
-- select EXTRACT(year from hire_date) as hire_year,count(*) as total_employees from hr.EMPLOYEES group by EXTRACT(year from hire_date) order by hire_year
-- select manager_id ,count(*) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,max(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,min(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,avg(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select EXTRACT(month from hire_date) as hire_month,count(*) as total_hired from hr.EMPLOYEES group by EXTRACT(month from hire_date) order by hire_month
-- SELECT department_id, SUM(salary) AS total_salary
-- FROM hr.employees
-- GROUP BY department_id
-- ORDER BY total_salary DESC
-- FETCH FIRST 1 ROW ONLY;
-- select job_id,avg(salary) as avg_saly from hr.EMPLOYEES group by job_id order by avg_saly FETCH FIRST 1 ROW ONLY
-- SELECT department_id, COUNT(*) AS employees_with_commission
-- FROM hr.employees
-- WHERE commission_pct IS NOT NULL
-- GROUP BY department_id;
-- SELECT department_id, SUM(salary) AS total_salary_with_commission
-- FROM hr.employees
-- WHERE commission_pct IS NOT NULL
-- GROUP BY department_id;

-- assigment
-- select department_id,count(*) as total_employees from hr.EMPLOYEES group by DEPARTMENT_ID
-- select department_id,avg(salary) as avg_salary from hr.EMPLOYEES group by department_id
-- select department_id ,max(salary) as max_salary from hr.EMPLOYEES group by DEPARTMENT_ID
-- select department_Id ,min(salary) as min_salary from hr.employees group by DEPARTMENT_ID
-- select department_Id,sum(salary) as sum_salary from hr.EMPLOYEES group by DEPARTMENT_ID
-- select job_id,count(*) as empolyee_count from hr.employees group by JOB_ID  
-- select job_id,avg(salary) as avg_salry from hr.employees GROUP by job_id
-- select job_id,max(salary) as max_salry from hr.employees GROUP by job_id
-- select job_id,min(salary) as min_salry from hr.employees GROUP by job_id
-- select job_id,sum(salary) as sum_salry from hr.employees GROUP by job_id
-- select EXTRACT(year from hire_date) as hire_year,count(*) as total_employees from hr.EMPLOYEES group by EXTRACT(year from hire_date) order by hire_year
-- select manager_id ,count(*) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,max(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,min(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select manager_id ,avg(salary) from hr.EMPLOYEES where MANAGER_ID is not null group by MANAGER_ID
-- select EXTRACT(month from hire_date) as hire_month,count(*) as total_hired from hr.EMPLOYEES group by EXTRACT(month from hire_date) order by hire_month
-- SELECT department_id, SUM(salary) AS total_salary
-- FROM hr.employees
-- GROUP BY department_id
-- ORDER BY total_salary DESC
-- FETCH FIRST 1 ROW ONLY;
-- select job_id,avg(salary) as avg_saly from hr.EMPLOYEES group by job_id order by avg_saly FETCH FIRST 1 ROW ONLY
-- SELECT department_id, COUNT(*) AS employees_with_commission
-- FROM hr.employees
-- WHERE commission_pct IS NOT NULL
-- GROUP BY department_id;
-- SELECT department_id, SUM(salary) AS total_salary_with_commission
-- FROM hr.employees
-- WHERE commission_pct IS NOT NULL
-- GROUP BY department_id;

-- assignment

-- 1. Count the number of sales transactions for each product.  
-- select PROD_ID,count(AMOUNT_SOLD) as total_sales_trasn from sh.sales
-- group by PROD_ID;

--Find the average sale amount for each product.  

-- select PROD_ID,avg(AMOUNT_SOLD) as avg_sales from sh.sales
-- group by PROD_ID;

--Find the maximum and minimum sale amount for each product. 
-- select PROD_ID,max(AMOUNT_SOLD) as max_sales,min(AMOUNT_SOLD) as min_sales from sh.sales
-- group by PROD_ID;

--Find the total revenue generated by each product.  
-- select PROD_ID,sum(AMOUNT_SOLD) as total_sales from sh.sales
-- group by PROD_ID;

--Count the number of sales transactions for each customer. 
-- select CUST_ID,count(AMOUNT_SOLD) number_of_sales  from sh.SALES
-- group by CUST_ID;

--Find the highest purchase amount for each customer. 
-- select CUST_ID,MAX(AMOUNT_SOLD) max_purchase_for_each_customer  from sh.SALES
-- group by CUST_ID;

--Find the highest purchase amount for each customer. 
-- select CUST_ID,MIN(AMOUNT_SOLD) min_purchase_for_each_customer  from sh.SALES
-- group by CUST_ID;

--Find the total revenue generated by each store location.
-- select cust_city,sum(AMOUNT_SOLD) as total_reven_by_loc from sh.customers cu
-- join sh.sales sa on cu.CUST_ID =sa.CUST_ID
-- group by cust_city;

-- 10. Count the number of sales transactions for each region.
-- select country_region,count(AMOUNT_SOLD) as num_of_trans_region from sh.countries co
-- join sh.customers cu on co.COUNTRY_ID =cu.COUNTRY_ID 
-- join sh.sales sa on cu.CUST_ID = sa.CUST_ID
-- group by country_region;

-- 11. Find the total revenue per region.  
-- select country_region,sum(AMOUNT_SOLD) from sh.COUNTRIES co join sh.customers cu on cu.COUNTRY_ID=co.COUNTRY_ID join sh.sales sa on cu.CUST_ID=sa.CUST_ID group by country_region

-- 12. Find the average sale amount per region. 
-- select country_region , avg(AMOUNT_SOLD) from sh.COUNTRIES co join sh.CUSTOMERS cu on cu.COUNTRY_ID=co.COUNTRY_ID join sh.sales sa on cu.cust_id=sa.CUST_ID group by co.COUNTRY_REGION

--Count the number of sales per month. 
-- select EXTRACT(month from time_id) as month ,count(AMOUNT_SOLD) from sh.sales group by month

-- 14. Find the total revenue per month.  
-- select extract(month from time_id) as month, sum(AMOUNT_SOLD) from sh.sales group by month

--Find the product that generated the highest revenue.
-- select prod_id,sum(Amount_sold) as total_sum from sh.sales  group by PROD_ID order by total_sum desc


-- 16. Find the most frequently purchased product. 
-- select prod_id,sum(quantity_sold) as frq from sh.sales group by PROD_ID order by frq desc

-- 17. Find the most valuable customer based on total spending.
-- select cust_id,sum(amount_sold) as total from sh.sales group by cust_id order by total desc

-- 18. Find the total revenue per sales channel (e.g., online vs. offline).
-- select channel_id ,sum(AMOUNT_SOLD) as total from sh.sales group by CHANNEL_ID order by total desc

-- 19. Count the number of sales for each payment method.  
-- select channel_id, count(quantity_sold) AS total from sh.sales group by channel_id order by total desc

-- 20. Find the total revenue generated per payment method. 
select channel_id,sum(AMOUNT_SOLD) as total from sh.sales group by channel_id order by total desc
